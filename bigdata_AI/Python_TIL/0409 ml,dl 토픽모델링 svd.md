## 토픽모델링

#### 1. SVD (특이값 분해)

> A가 m*n 행렬일  때,  A=UΣVT
>
> - U : m×m 직교행렬
>
> - V : n×n 직교행렬 
>
> - Σ :  m×n 직사각 대각행렬
>
>   * 직교행렬 -   [ A*AT = I ]  / [ A^-1=AT]
>   * 대각행렬 -   주대각선을 제외한 곳의 원소가 모두 0인 행렬 
>
>
> ex) 행렬 a가 4*9 행렬일 때, a = UΣVT = (4x4) * (4x9) * (9x9) = (4x9)



``` python
import numpy as np


a=np.array([[0,0,0,1,0,1,1,0,0],
          [0,0,0,1,1,0,1,0,0],
          [0,1,1,0,2,0,0,0,0],
          [1,0,0,0,0,0,0,1,1]])


### 1) full-SVD
U, s, VT = np.linalg.svd(a,full_matrices=True)

## U : m×m 직교행렬
U.round(2)
> array([[-0.24,  0.75,  0.  , -0.62],
       [-0.51,  0.44, -0.  ,  0.74],
       [-0.83, -0.49, -0.  , -0.27],
       [-0.  , -0.  ,  1.  ,  0.  ]]) #  4x4

## Σ :  m×n 직사각 대각행렬
s.round(2)
> array([2.69, 2.05, 1.73, 0.77])    # 4x1

# 특이값 행렬
S=np.zeros((4,9))
S[:4,:4]=np.diag(s)
S.round(2)
> array([[2.69, 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
       [0.  , 2.05, 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
       [0.  , 0.  , 1.73, 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
       [0.  , 0.  , 0.  , 0.77, 0.  , 0.  , 0.  , 0.  , 0.  ]])     # 4x9

# V : n×n 직교행렬 
VT.round(2)
> array([[-0.  , -0.31, -0.31, -0.28, -0.8 , -0.09, -0.28, -0.  , -0.  ],
       [ 0.  , -0.24, -0.24,  0.58, -0.26,  0.37,  0.58, -0.  , -0.  ],
       [ 0.58, -0.  ,  0.  ,  0.  , -0.  ,  0.  , -0.  ,  0.58,  0.58],
       [ 0.  , -0.35, -0.35,  0.16,  0.25, -0.8 ,  0.16, -0.  , -0.  ],
       [-0.  , -0.78, -0.01, -0.2 ,  0.4 ,  0.4 , -0.2 ,  0.  ,  0.  ],
       [-0.29,  0.31, -0.78, -0.24,  0.23,  0.23,  0.01,  0.14,  0.14],
       [-0.29, -0.1 ,  0.26, -0.59, -0.08, -0.08,  0.66,  0.14,  0.14],
       [-0.5 , -0.06,  0.15,  0.24, -0.05, -0.05, -0.19,  0.75, -0.25],
       [-0.5 , -0.06,  0.15,  0.24, -0.05, -0.05, -0.19, -0.25,  0.75]])    # 9x9

## A=UΣVT
np.dot((np.dot(U,S)),VT).round(2)
> array([[ 0.,  0.,  0.,  1., -0.,  1.,  1.,  0.,  0.],
       [ 0., -0., -0.,  1.,  1., -0.,  1., -0., -0.],
       [ 0.,  1.,  1., -0.,  2., -0., -0.,  0.,  0.],
       [ 1., -0.,  0.,  0., -0.,  0., -0.,  1.,  1.]])   # 4x9

np.allclose(a,np.dot((np.dot(U,S)),VT).round(2))
> True

--------------------------------------------------------

### 2) truncated-SVD

## Σ :  m×n 직사각 대각행렬
S=S[:2,:2]
S.round(2)
> array([[2.69, 0.  ],
       [0.  , 2.05]])   # 2x2

## U : 4개 문서 각각에 대한 잠재의미를 나타내는 수치문서 vector
U=U[:,:2]  
U.round(2)
> array([[-0.24,  0.75],
       [-0.51,  0.44],
       [-0.83, -0.49],
       [-0.  , -0.  ]])     # 4x2

# VT = (토픽*잠재의미)를 나타내는 수치화된 단어 vector
VT=VT[:2,:]
VT.round(2)
> array([[-0.  , -0.31, -0.31, -0.28, -0.8 , -0.09, -0.28, -0.  , -0.  ],
       [ 0.  , -0.24, -0.24,  0.58, -0.26,  0.37,  0.58, -0.  , -0.  ]])   # 2x9

## A=UΣVT
np.dot(np.dot(U,S),VT).round(2)
> array([[ 0.  , -0.17, -0.17,  1.08,  0.12,  0.62,  1.08, -0.  , -0.  ],
       [ 0.  ,  0.2 ,  0.2 ,  0.91,  0.86,  0.45,  0.91,  0.  ,  0.  ],
       [ 0.  ,  0.93,  0.93,  0.03,  2.05, -0.17,  0.03,  0.  ,  0.  ],
       [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  , -0.  ,  0.  ,  0.  ,  0.  ]])   # 4x9

```

